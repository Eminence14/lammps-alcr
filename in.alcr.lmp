########## INITIALIZATION ##########
units           metal
dimension       3
boundary        p p p
atom_style      atomic

########## ATOM DEFINITION (PART 1: BOX SETUP) ##########
lattice         fcc 4.05 orient x 1 0 0 orient y 0 1 0 orient z 0 0 1
region          whole block 0 12 0 12 0 12 units lattice
create_box      2 whole     # Create a box that holds 2 atom types
create_atoms    1 region whole

########## INTERATOMIC POTENTIAL DEFINITION (MEAM) ##########
pair_style      meam
pair_coeff      * * library.meam Al Cr CrAl.meam Al Cr

# --- Define Alloy Concentration ---
# Set a variable for Chromium percentage (e.g., 0.10 for 10%)
variable        Cr_percent equal 0.10
set             group all type/fraction 2 ${Cr_percent} 12345

########## DEFINE COMPUTES ##########
compute         csym all centro/atom fcc
compute         peratom all pe/atom

########## ENERGY MINIMIZATION ##########
minimize        1.0e-10 1.0e-10 10000 10000
reset_timestep  0

########## EQUILIBRATION (NPT) ##########
reset_timestep  0
timestep        0.001   # 1 fs timestep
velocity        all create 300 12345 mom yes rot no
fix             1 all npt temp 300 300 1 iso 0 0 1 drag 1

# Set thermo output for equilibration
# Include press to ensure pressure components are available
thermo          1000
thermo_style    custom step temp pe press pxx pyy pzz lx ly lz

# Run equilibration for 50,000 steps (50 ps)
run             50000
unfix           1

# Store final cell length for strain calculations
variable        L0 equal "lx"
print           "Initial cell length, L0 = ${L0}"

########## DEFORMATION ##########
reset_timestep  0

# Fix NPT: T=300K. P=0 bar in Y and Z. X-direction is controlled by 'deform'.
fix             1 all npt temp 300 300 1 y 0 0 1 z 0 0 1 drag 1

# Define engineering strain rate (e.g., 1e10 /s)
variable        srate equal 1.0e10
variable        srate_lammps equal "v_srate / 1.0e12" # Convert to 1/ps

# Apply deformation
fix             2 all deform 1 x erate ${srate_lammps} units box remap x

# --- Output strain and stress info to file ---
variable        strain equal "(lx - v_L0) / v_L0"
variable        px equal "-pxx/10000"  # Tensile stress (GPa)
variable        py equal "-pyy/10000"  # Transverse stress (GPa)
variable        pz equal "-pzz/10000"  # Transverse stress (GPa)

fix             3 all print 1000 "${strain} ${px} ${py} ${pz}" file tensile_alcr_meam.csv screen no title "Strain, Stress_x(GPa), Stress_y(GPa), Stress_z(GPa)"

# Dumping Output for Al-Cr Alloy
dump            1 all custom 2000 dump.tensile_alcr id mass type xs ys zs c_csym c_peratom fx fy fz
dump_modify     1 element Al Cr

thermo          2000
thermo_style    custom step temp pe press pxx pyy pzz v_strain v_px v_py v_pz

########## RUN DEFORMATION ##########
# Run deformation for 100,000 steps (100 ps)
run             100000
print           "Simulation completed."